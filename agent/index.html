<!doctype html><html id=R-html lang=en-us dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=html><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.152.2"><meta name=generator content="Relearn 9.0.3"><meta name=description content="For certain use cases, it is useful to run YAML Manifests continuously. For example, you might not want to manage your dotfiles automatically (allowing for local modifications), but you do want to keep Docker up to date.
The CCM Agent runs manifests continuously, loading them from local files, Object Storage, or HTTP(S) URLs, with Key-Value data overlaid.
In time, the Agent will become a key part of a service registry system, allowing for continuous monitoring of managed resources and sharing that state into a registryâ€”enabling other nodes to use file resources to create configurations that combine knowledge of all nodes."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Agent :: Choria Configuration Manager"><meta name=twitter:description content="For certain use cases, it is useful to run YAML Manifests continuously. For example, you might not want to manage your dotfiles automatically (allowing for local modifications), but you do want to keep Docker up to date.
The CCM Agent runs manifests continuously, loading them from local files, Object Storage, or HTTP(S) URLs, with Key-Value data overlaid.
In time, the Agent will become a key part of a service registry system, allowing for continuous monitoring of managed resources and sharing that state into a registryâ€”enabling other nodes to use file resources to create configurations that combine knowledge of all nodes."><meta property="og:url" content="https://choria-cm.dev/agent/index.html"><meta property="og:site_name" content="Choria Configuration Manager"><meta property="og:title" content="Agent :: Choria Configuration Manager"><meta property="og:description" content="For certain use cases, it is useful to run YAML Manifests continuously. For example, you might not want to manage your dotfiles automatically (allowing for local modifications), but you do want to keep Docker up to date.
The CCM Agent runs manifests continuously, loading them from local files, Object Storage, or HTTP(S) URLs, with Key-Value data overlaid.
In time, the Agent will become a key part of a service registry system, allowing for continuous monitoring of managed resources and sharing that state into a registryâ€”enabling other nodes to use file resources to create configurations that combine knowledge of all nodes."><meta property="og:locale" content="en_us"><meta property="og:type" content="website"><meta itemprop=name content="Agent :: Choria Configuration Manager"><meta itemprop=description content="For certain use cases, it is useful to run YAML Manifests continuously. For example, you might not want to manage your dotfiles automatically (allowing for local modifications), but you do want to keep Docker up to date.
The CCM Agent runs manifests continuously, loading them from local files, Object Storage, or HTTP(S) URLs, with Key-Value data overlaid.
In time, the Agent will become a key part of a service registry system, allowing for continuous monitoring of managed resources and sharing that state into a registryâ€”enabling other nodes to use file resources to create configurations that combine knowledge of all nodes."><meta itemprop=wordCount content="844"><title>Agent :: Choria Configuration Manager</title><link href=/agent/index.xml rel=alternate type=application/rss+xml title="Agent :: Choria Configuration Manager"><link href=/agent/index.print.html rel=alternate type=text/html title="Agent :: Choria Configuration Manager"><link href=/agent/index.md rel=alternate type=text/markdown title="Agent :: Choria Configuration Manager"><link href=/css/auto-complete/auto-complete.min.css?1769793619 rel=stylesheet><script src=/js/auto-complete/auto-complete.min.js?1769793619 defer></script><script src=/js/search-lunr.min.js?1769793619 defer></script><script src=/js/search.min.js?1769793619 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="/searchindex.en.js?1769793619"</script><script src=/js/lunr/lunr.min.js?1769793619 defer></script><script src=/js/lunr/lunr.stemmer.support.min.js?1769793619 defer></script><script src=/js/lunr/lunr.multi.min.js?1769793619 defer></script><script src=/js/lunr/lunr.en.min.js?1769793619 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=/fonts/fontawesome/css/all.min.css?1769793619 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/fonts/fontawesome/css/all.min.css?1769793619 rel=stylesheet></noscript><link href=/css/perfect-scrollbar/perfect-scrollbar.min.css?1769793619 rel=stylesheet><link href=/css/theme.min.css?1769793619 rel=stylesheet><link href=/css/format-html.min.css?1769793619 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/agent/index.html",window.relearn.relBasePath="..",window.relearn.relBaseUri="..",window.relearn.absBaseUri="https://choria-cm.dev",window.relearn.disableInlineCopyToClipboard=!0,window.relearn.enableBlockCodeWrap=!0,window.T_Copy_to_clipboard=`Copy text to clipboard`,window.T_Copied_to_clipboard=`Text copied to clipboard!`,window.T_Link_copied_to_clipboard=`Link copied to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.T_Browser_unsupported_feature=`This browser doesn't support this feature`,window.relearn.themevariants=["zen-auto","zen-light","ccm"],window.relearn.customvariantprefix="my-custom-",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.localStorage.getItem(window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.localStorage.getItem(window.relearn.absBaseUri+"/variant")??"";(!e||!e.startsWith(window.relearn.customvariantprefix)&&!window.relearn.themevariants.includes(e)||e.startsWith(window.relearn.customvariantprefix)&&!window.localStorage.getItem(window.relearn.absBaseUri+"/variantstylesheet-"+e))&&(e=window.relearn.themevariants[0],window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><script src=https://cdn.counter.dev/script.js data-id=a4622abe-f6fa-4cac-a337-a4437915e4b3></script></head><body class="mobile-support html" data-origin=/agent/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar class=default-animation><div class="topbar-wrapper default-animation"><div class="topbar-sidebar-divider default-animation"></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar default-animation" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><span class="btn cstyle button link noborder notitle interactive"><button onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></span></div><div class="topbar-button topbar-button-toc default-animation" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-table-list"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#run-modes>Run Modes</a></li><li><a href=#supported-manifest-and-data-sources>Supported Manifest and Data Sources</a><ul><li><a href=#manifest-sources>Manifest Sources</a></li><li><a href=#external-data-sources>External Data Sources</a></li></ul></li><li><a href=#logical-flow>Logical Flow</a></li><li><a href=#prometheus-metrics>Prometheus Metrics</a><ul><li><a href=#agent-metrics>Agent Metrics</a></li><li><a href=#resource-metrics>Resource Metrics</a></li><li><a href=#health-check-metrics>Health Check Metrics</a></li><li><a href=#facts-metrics>Facts Metrics</a></li></ul></li><li><a href=#configuration>Configuration</a></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/index.html><span itemprop=name>Introduction</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Agent</span><meta itemprop=position content="2"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-markdown default-animation" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><a href=/agent/index.md title="Show Markdown"><i class="fa-fw fab fa-markdown"></i></a></span></div><div class="topbar-button topbar-button-print default-animation" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><a href=/agent/index.print.html title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></span></div><div class="topbar-button topbar-button-prev default-animation" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><a href=/yamlmanifests/index.html title="YAML Manifests (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span></div><div class="topbar-button topbar-button-next default-animation" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><a href=/monitoring/index.html title="Monitoring (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span></div><div class="topbar-button topbar-button-more default-animation" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable agent" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=agent>Agent</h1><p>For certain use cases, it is useful to run <a href=/yamlmanifests/index.html>YAML Manifests</a> continuously. For example, you might not want to manage your <code>dotfiles</code> automatically (allowing for local modifications), but you do want to keep Docker up to date.</p><p>The CCM Agent runs manifests continuously, loading them from local files, Object Storage, or HTTP(S) URLs, with Key-Value data overlaid.</p><p>In time, the Agent will become a key part of a service registry system, allowing for continuous monitoring of managed resources and sharing that state into a registryâ€”enabling other nodes to use <code>file</code> resources to create configurations that combine knowledge of all nodes.</p><h2 id=run-modes>Run Modes<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2><p>The agent supports two modes of operation that combine to be efficient and fast-reacting:</p><ul><li><strong>Full manifest apply</strong>: Manages the complete state of every resource</li><li><strong>Health check mode</strong>: Runs only <a href=/monitoring/index.html>Monitoring</a> checks, which can trigger a full manifest apply as remediation</li></ul><p>By enabling both modes, you can run health checks very frequently (even at 10- or 20-second intervals) while keeping full Configuration Management runs less frequent (every few hours).</p><p>Enabling both modes is optional but recommended. We also recommend adding health checks to your key resources.</p><h2 id=supported-manifest-and-data-sources>Supported Manifest and Data Sources<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2><h3 id=manifest-sources>Manifest Sources<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3><p>Manifests can be loaded from:</p><ul><li><strong>Local file</strong>: <code>/path/to/manifest.yaml</code></li><li><strong>Object Storage</strong>: <code>obj://bucket/key.tar.gz</code></li><li><strong>HTTP(S)</strong>: <code>https://example.com/manifest.tar.gz</code> (supports Basic Auth via URL credentials)</li></ul><p>Remote sources (Object Storage and HTTP) must be <code>.tar.gz</code> archives containing a <code>manifest.yaml</code> file, templates and file sources.</p><h3 id=external-data-sources>External Data Sources<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3><p>For Hiera data resolution, the agent supports:</p><ul><li><strong>Local file</strong>: <code>file:///path/to/data.yaml</code></li><li><strong>Key-Value store</strong>: <code>kv://bucket/key</code></li><li><strong>HTTP(S)</strong>: <code>https://example.com/data.yaml</code></li></ul><h2 id=logical-flow>Logical Flow<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2><p>The agent continuously runs and manages manifests as follows:</p><ol><li>At startup, the agent fetches data and gathers facts</li><li>Starts a worker for each manifest source<ol><li>Each worker starts watchers to download and manage the manifest (polling every 30 seconds for remote sources)</li></ol></li><li>Triggers workers at the configured interval for a full apply<ol><li>Each run updates facts (minimum 2-minute interval) and data</li><li>Applies each manifest serially</li></ol></li><li>Triggers workers at the configured health check interval<ol><li>Health check runs do not update facts or data</li><li>Runs health checks for each manifest serially</li><li>If any health checks are critical (not warning), the agent triggers a full apply for that worker</li></ol></li></ol><p>In the background, object stores and HTTP sources are watched for changes. Updates trigger immediate apply runs with exponential backoff retry on failures.</p><h2 id=prometheus-metrics>Prometheus Metrics<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2><p>When <code>monitor_port</code> is configured, the agent exposes Prometheus metrics on <code>/metrics</code>. These metrics can be used to monitor agent health, track resource states and events, and observe health check statuses.</p><h3 id=agent-metrics>Agent Metrics<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3><table><thead><tr><th>Metric</th><th>Type</th><th>Labels</th><th>Description</th></tr></thead><tbody><tr><td><code>choria_ccm_agent_apply_duration_seconds</code></td><td>Summary</td><td>manifest</td><td>Time taken to apply manifests</td></tr><tr><td><code>choria_ccm_agent_healthcheck_duration_seconds</code></td><td>Summary</td><td>manifests</td><td>Time taken for health check runs</td></tr><tr><td><code>choria_ccm_agent_healthcheck_remediations_count</code></td><td>Counter</td><td>manifest</td><td>Health checks that triggered remediation</td></tr><tr><td><code>choria_ccm_agent_data_resolve_duration_seconds</code></td><td>Summary</td><td>-</td><td>Time taken to resolve external data</td></tr><tr><td><code>choria_ccm_agent_data_resolve_error_count</code></td><td>Counter</td><td>url</td><td>Data resolution failures</td></tr><tr><td><code>choria_ccm_agent_facts_resolve_duration_seconds</code></td><td>Summary</td><td>-</td><td>Time taken to resolve facts</td></tr><tr><td><code>choria_ccm_agent_facts_resolve_error_count</code></td><td>Counter</td><td>-</td><td>Facts resolution failures</td></tr><tr><td><code>choria_ccm_agent_manifest_fetch_count</code></td><td>Counter</td><td>manifest</td><td>Remote manifest fetches</td></tr><tr><td><code>choria_ccm_agent_manifest_fetch_error_count</code></td><td>Counter</td><td>manifest</td><td>Remote manifest fetch failures</td></tr></tbody></table><h3 id=resource-metrics>Resource Metrics<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3><table><thead><tr><th>Metric</th><th>Type</th><th>Labels</th><th>Description</th></tr></thead><tbody><tr><td><code>choria_ccm_manifest_apply_duration_seconds</code></td><td>Summary</td><td>source</td><td>Time taken to apply an entire manifest</td></tr><tr><td><code>choria_ccm_resource_apply_duration_seconds</code></td><td>Summary</td><td>type, provider, name</td><td>Time taken to apply a resource</td></tr><tr><td><code>choria_ccm_resource_state_total_count</code></td><td>Counter</td><td>type, name</td><td>Total resources processed</td></tr><tr><td><code>choria_ccm_resource_state_stable_count</code></td><td>Counter</td><td>type, name</td><td>Resources in stable state</td></tr><tr><td><code>choria_ccm_resource_state_changed_count</code></td><td>Counter</td><td>type, name</td><td>Resources that changed</td></tr><tr><td><code>choria_ccm_resource_state_refreshed_count</code></td><td>Counter</td><td>type, name</td><td>Resources that were refreshed</td></tr><tr><td><code>choria_ccm_resource_state_failed_count</code></td><td>Counter</td><td>type, name</td><td>Resources that failed</td></tr><tr><td><code>choria_ccm_resource_state_error_count</code></td><td>Counter</td><td>type, name</td><td>Resources with errors</td></tr><tr><td><code>choria_ccm_resource_state_skipped_count</code></td><td>Counter</td><td>type, name</td><td>Resources that were skipped</td></tr><tr><td><code>choria_ccm_resource_state_noop_count</code></td><td>Counter</td><td>type, name</td><td>Resources in noop mode</td></tr></tbody></table><h3 id=health-check-metrics>Health Check Metrics<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3><table><thead><tr><th>Metric</th><th>Type</th><th>Labels</th><th>Description</th></tr></thead><tbody><tr><td><code>choria_ccm_healthcheck_duration_seconds</code></td><td>Summary</td><td>type, name, check</td><td>Time taken for health checks</td></tr><tr><td><code>choria_ccm_healthcheck_status_count</code></td><td>Counter</td><td>type, name, status, check</td><td>Health check results by status</td></tr></tbody></table><h3 id=facts-metrics>Facts Metrics<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3><table><thead><tr><th>Metric</th><th>Type</th><th>Labels</th><th>Description</th></tr></thead><tbody><tr><td><code>choria_ccm_facts_gather_duration_seconds</code></td><td>Summary</td><td>-</td><td>Time taken to gather system facts</td></tr></tbody></table><h2 id=configuration>Configuration<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title="Copy link to clipboard"><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2><p>The agent is included in the <code>ccm</code> binary. To use it, create a configuration file and enable the systemd service.</p><p>The configuration file is located at <code>/etc/choria/ccm/config.yaml</code>:</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># CCM Agent Configuration Example</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Time between scheduled manifest apply runs.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Must be at least 30s. Defaults to 5m.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>interval</span>: <span style=color:#ae81ff>5m</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Time between health check runs.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># When set, health checks run independently of apply runs and can trigger</span>
</span></span><span style=display:flex><span><span style=color:#75715e># remediation applies when critical issues are detected.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Omit to disable periodic health checks.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>health_check_interval</span>: <span style=color:#ae81ff>1m</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># List of manifest sources to apply. Each source creates a separate worker.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Supported formats:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   - Local file: /path/to/manifest.yaml</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   - Object store: obj://bucket/key.tar.gz</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   - HTTP(S): https://example.com/manifest.tar.gz</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   - HTTP with Basic Auth: https://user:pass@example.com/manifest.tar.gz</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Remote sources must be .tar.gz archives containing a manifest.yaml file.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>manifests</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>/etc/choria/ccm/manifests/base.yaml</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>obj://ccm-manifests/app.tar.gz</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>https://config.example.com/manifests/web.tar.gz</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Logging level: debug, info, warn, error</span>
</span></span><span style=display:flex><span><span style=color:#f92672>log_level</span>: <span style=color:#ae81ff>info</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># NATS context for authentication. Defaults to &#39;CCM&#39;.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>nats_context</span>: <span style=color:#ae81ff>CCM</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Optional URL for external Hiera data resolution.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Supported formats: file://, kv://, http(s)://</span>
</span></span><span style=display:flex><span><span style=color:#75715e># The resolved data is merged into the manifest data context.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>external_data_url</span>: <span style=color:#ae81ff>kv://ccm-data/common</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Directory for caching remote manifest sources.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Defaults to /etc/choria/ccm/source.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>cache_dir</span>: <span style=color:#ae81ff>/etc/choria/ccm/source</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Port for Prometheus metrics endpoint (/metrics).</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set to 0 or omit to disable.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>monitor_port</span>: <span style=color:#ae81ff>9100</span></span></span></code></pre></div><p>After configuring, start the service:</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0><code class=language-nohighlight data-lang=nohighlight>ccm ensure service ccm-agent running --enable</code></pre></div><footer class=footline></footer></article></div></main></div><aside id=R-sidebar class=default-animation><div id=R-header-topbar class=default-animation></div><div id=R-header-wrapper class=default-animation><img src=/logo.png>
<search><form action=/search/index.html method=get><div class="searchbox default-animation"><button class=search-detail type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-fw fa-search"></i></button>
<label class=a11y-only for=R-search-by>Search</label>
<input data-search-input id=R-search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-fw fa-times" title="Clear search"></i></button></div></form></search></div><div id=R-homelinks class="default-animation homelinks"><div class="R-menu-divider default-animation"><hr class="padding default-animation"></div><div class="R-sidebarmenu R-shortcutmenu-homelinks default-animation"><ul class="space collapsible-menu"><li data-nav-id=/index.html><a class=padding href=/index.html><i class="fa-fw fas fa-home"></i> Home</a></li></ul></div><div class="R-menu-divider default-animation"><hr class="padding default-animation"></div><div class="R-sidebarmenu R-shortcutmenu-headercontrols default-animation"><ul></ul></div><div class="R-menu-divider default-animation"><hr class="padding default-animation"></div></div><div id=R-content-wrapper class=highlightable><div class="R-sidebarmenu R-shortcutmenu-main default-animation"><ul class="enlarge morespace collapsible-menu"><li data-nav-id=/resources/index.html><a class=padding href=/resources/index.html><b>1. </b>Resources</a></li><li data-nav-id=/hiera/index.html><a class=padding href=/hiera/index.html><b>2. </b>Hierarchical Data</a></li><li data-nav-id=/data/index.html><a class=padding href=/data/index.html><b>3. </b>Data</a></li><li data-nav-id=/cli/index.html><input type=checkbox id=R-section-4fd2725e492e69224fa1e9952b51cf04 aria-controls=R-subsections-4fd2725e492e69224fa1e9952b51cf04><label for=R-section-4fd2725e492e69224fa1e9952b51cf04><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu Shell Usage</span></label><a class="padding default-animation" href=/cli/index.html><b>4. </b>Shell Usage</a><ul id=R-subsections-4fd2725e492e69224fa1e9952b51cf04 class=collapsible-menu><li data-nav-id=/cli/api/index.html><a class=padding href=/cli/api/index.html>JSON API</a></li><li data-nav-id=/cli/plugins/index.html><a class=padding href=/cli/plugins/index.html>CLI Plugins</a></li></ul></li><li data-nav-id=/yamlmanifests/index.html><a class=padding href=/yamlmanifests/index.html><b>5. </b>YAML Manifests</a></li><li class=active data-nav-id=/agent/index.html><a class=padding href=/agent/index.html><b>6. </b>Agent</a></li><li data-nav-id=/monitoring/index.html><a class=padding href=/monitoring/index.html><b>7. </b>Monitoring</a></li><li data-nav-id=/design/index.html><input type=checkbox id=R-section-584881683b3574eff66f4a8e3d60d561 aria-controls=R-subsections-584881683b3574eff66f4a8e3d60d561><label for=R-section-584881683b3574eff66f4a8e3d60d561><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu Design Documents</span></label><a class="padding default-animation" href=/design/index.html><b>8. </b>Design Documents</a><ul id=R-subsections-584881683b3574eff66f4a8e3d60d561 class=collapsible-menu><li data-nav-id=/design/archive/index.html><input type=checkbox id=R-section-f63d49c69bdc840846aa6a8268f92749 aria-controls=R-subsections-f63d49c69bdc840846aa6a8268f92749><label for=R-section-f63d49c69bdc840846aa6a8268f92749><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu Archive Type</span></label><a class="padding default-animation" href=/design/archive/index.html>Archive Type</a><ul id=R-subsections-f63d49c69bdc840846aa6a8268f92749 class=collapsible-menu><li data-nav-id=/design/archive/http/index.html><a class=padding href=/design/archive/http/index.html>HTTP Provider</a></li></ul></li><li data-nav-id=/design/exec/index.html><input type=checkbox id=R-section-9b368c08d1a137b59b283b6981ee60d0 aria-controls=R-subsections-9b368c08d1a137b59b283b6981ee60d0><label for=R-section-9b368c08d1a137b59b283b6981ee60d0><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu Exec Type</span></label><a class="padding default-animation" href=/design/exec/index.html>Exec Type</a><ul id=R-subsections-9b368c08d1a137b59b283b6981ee60d0 class=collapsible-menu><li data-nav-id=/design/exec/posix/index.html><a class=padding href=/design/exec/posix/index.html>Posix Provider</a></li><li data-nav-id=/design/exec/shell/index.html><a class=padding href=/design/exec/shell/index.html>Shell Provider</a></li></ul></li><li data-nav-id=/design/file/index.html><input type=checkbox id=R-section-53cc62c1ec6218328b86b6622a2f399b aria-controls=R-subsections-53cc62c1ec6218328b86b6622a2f399b><label for=R-section-53cc62c1ec6218328b86b6622a2f399b><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu File Type</span></label><a class="padding default-animation" href=/design/file/index.html>File Type</a><ul id=R-subsections-53cc62c1ec6218328b86b6622a2f399b class=collapsible-menu><li data-nav-id=/design/file/posix/index.html><a class=padding href=/design/file/posix/index.html>Posix Provider</a></li></ul></li><li data-nav-id=/design/package/index.html><input type=checkbox id=R-section-a8e95d0722db79d6914371d6385ce2fd aria-controls=R-subsections-a8e95d0722db79d6914371d6385ce2fd><label for=R-section-a8e95d0722db79d6914371d6385ce2fd><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu Package Type</span></label><a class="padding default-animation" href=/design/package/index.html>Package Type</a><ul id=R-subsections-a8e95d0722db79d6914371d6385ce2fd class=collapsible-menu><li data-nav-id=/design/package/apt/index.html><a class=padding href=/design/package/apt/index.html>APT Provider</a></li><li data-nav-id=/design/package/dnf/index.html><a class=padding href=/design/package/dnf/index.html>DNF Provider</a></li></ul></li><li data-nav-id=/design/service/index.html><input type=checkbox id=R-section-38b133cba72d76df475491ca1b75250e aria-controls=R-subsections-38b133cba72d76df475491ca1b75250e><label for=R-section-38b133cba72d76df475491ca1b75250e><i class="fa-fw fas fa-chevron-right"></i><span class=a11y-only>Submenu Service Type</span></label><a class="padding default-animation" href=/design/service/index.html>Service Type</a><ul id=R-subsections-38b133cba72d76df475491ca1b75250e class=collapsible-menu><li data-nav-id=/design/service/systemd/index.html><a class=padding href=/design/service/systemd/index.html>Systemd Provider</a></li></ul></li></ul></li></ul></div><div class="R-sidebarmenu R-shortcutmenu-shortcuts default-animation"><div class="nav-title padding">More</div><ul class="space collapsible-menu"><li data-nav-id=https://github.com/choria-io/ccm><a class=padding href=https://github.com/choria-io/ccm rel=external><i class='fab fa-fw fa-github'></i> GitHub</a></li><li data-nav-id=https://github.com/choria-io/ccm/releases><a class=padding href=https://github.com/choria-io/ccm/releases rel=external><i class='far fa-save'></i> Download</a></li><li data-nav-id=https://github.com/choria-io/ccm/discussions><a class=padding href=https://github.com/choria-io/ccm/discussions rel=external><i class='far fa-comments'></i> Discussions</a></li><li data-nav-id=https://github.com/choria-io/ccm/issues><a class=padding href=https://github.com/choria-io/ccm/issues rel=external><i class='far fa-life-ring'></i> Issues</a></li><li data-nav-id=https://short.voxpupu.li/puppetcommunity_slack_signup><a class=padding href=https://short.voxpupu.li/puppetcommunity_slack_signup rel=external><i class='fab fa-slack'></i> #choria</a></li></ul></div><div id=R-footer-margin class=default-animation></div><div class="R-menu-divider default-animation"><hr class="padding default-animation"></div><div class="R-sidebarmenu R-shortcutmenu-footercontrols default-animation"><ul><li class=R-variantswitcher><div class="padding menu-control"><i class="fa-fw fas fa-paint-brush"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=R-select-variant>Theme</label>
<select id=R-select-variant><option id=R-select-variant-zen-auto value=zen-auto selected>Auto Theme</option><option id=R-select-variant-zen-light value=zen-light>Light</option><option id=R-select-variant-ccm value=ccm>Dark</option></select></div><div class=clear></div></div><script>window.relearn.markVariant()</script></li></ul></div><div id=R-footer class=default-animation><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=/js/perfect-scrollbar/perfect-scrollbar.min.js?1769793619 defer></script><script src=/js/theme.min.js?1769793619 defer></script><div id=toast-container role=status aria-live=polite aria-atomic=false></div></body></html>